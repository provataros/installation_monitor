<head>
  <title>Installation_Status</title>
  <link href='https://fonts.googleapis.com/css?family=Roboto&subset=latin,greek' rel='stylesheet' type='text/css'>
</head>

<body>
  <div id = "side_panel">
    {{> side_panel}}
  </div>
  <div id="content">
    {{#if selected_device}}
      {{> device}}
    {{else}}
      {{> search_bar}}
      {{> search_results}}
    {{/if}}
  </div>

</body>

<template name = "side_panel">
    {{#with device}}
    {{debug this}}
      <button id = "back">Back</button>
      <button id = "save">Save</button>
      <button id = "reset">Reset</button>
      <button id = "copy">Copy</button>
      <button id = "delete">Delete</button>

    {{/with}}
    <button>New</button>
</template>

<template name = "controls">
  <div class = "control_bar"></div>
</template>

<template name = "search_bar">

  <div class = "search_panel">
    <div class = "search_div">
      <label>Hardware Id</label>
      <input class = "search_input" type = "text" id = "s_hwid" value = "{{fromSession 's_hwid'}}">
    </div>
    <div class = "search_div">
      <label>Device Id</label>
      <input class = "search_input"  type = "text" id = "s_deid" value = "{{fromSession 's_deid'}}">
    </div>
    <div class = "search_div">
      <label>Service Account Id</label>
      <input class = "search_input"  type = "text" id = "s_said" value = "{{fromSession 's_said'}}">
    </div>
    <div class = "search_div">
      <label>LSAM Id</label>
      <input class = "search_input"  type = "text" id = "s_lsam" value = "{{fromSession 's_lsam'}}">
    </div>
    <div class = "search_div">
      <label>Device Type</label>
      <select class = "search_input" id = "s_device_type">
        <option></option>
        <option {{selected_type "ACIM" }} value  = "ACIM">ACIM</option>
        <option {{selected_type "TIT" }} value = "TIT">TIT</option>
        <option {{selected_type "CIT" }} value = "CIT">CIT</option>
        <option {{selected_type "PCRS" }} value = "PCRS">PCRS</option>
        <option {{selected_type "PSCCS" }} value = "PSCCS">PSCCS</option>
        <option {{selected_type "OVMC" }} value = "OVMC">OVMC</option>
      </select>
    </div>
    <div class = "search_div">
      <label>Agency</label>
      <select class = "search_input" id = "s_agency">
        <option></option>
        <option {{selected_agency "OASA" }} value = "OASA">OASA</option>
        <option {{selected_agency "STASY" }} value = "STASY">STASY</option>
        <option {{selected_agency "OSY" }} value = "OSY">OSY</option>
        <option {{selected_agency "TRAINOSE" }} value = "TRAINOSE">TRAINOSE</option>
      </select>
    </div>
    <div class = "search_div">
      <label>Installation Status</label>
      <select class = "search_input" id = "s_sw_status">
        <option></option>
        <option {{selected_sw_status "Operating System Update" }} value = "Operating System Update">Operating System Update</option>
        <option {{selected_sw_status "Firmware Update" }} value = "Firmware Update">Firmware Update</option>
        <option {{selected_sw_status "Testing" }} value = "Testing">Testing</option>
        <option {{selected_sw_status "Done" }} value = "Done">Done</option>
      </select>
    </div>
    <div class = "search_div">
      <label>Urgent</label>
      <input class = "search_input"  type = "checkbox" id = "s_urgent" {{isCheckedSession 's_urgent'}}>
    </div>
    <div class = "search_div">
      <label>Error</label>
      <input class = "search_input"  type = "checkbox" id = "s_error" {{isCheckedSession 's_error'}}>
    </div>
    <br>
    <div class = "search_div">
      <label>Install Date</label>
      <input id = "search_install_date" class = "showbox" type = "checkbox" {{isCheckedSession 'search_install_date'}}>
      <div id = "install_date_div" class = "checkboxDiv">
        {{debug isCheckedSessionB "search_install_date"}}
        {{#if isCheckedSessionB "search_install_date"}}
          {{> searchDate "from_install_date"}}
          {{> searchDate "untl_install_date"}}
        {{/if}}
      </div>
    </div>
    <br>
    <div class = "search_div">
      <label>Schedule Date</label>
      <input id = "search_schedule_date" class = "showbox" type = "checkbox" {{isCheckedSession 'search_schedule_date'}}>
      <div id = "schedule_date_div" class = "checkboxDiv">
        {{#if isCheckedSessionB "search_schedule_date"}}
          {{> searchDate "from_schedule_date"}}
          {{> searchDate "untl_schedule_date"}}
        {{/if}}
      </div>
    </div>
    <br>
    <!-- <div class = "search_div">
      <label>Register Date</label>
      <input id = "search_register_date" class = "showbox" type = "checkbox">
      <div id = "register_date_div" class = "checkboxDiv">
        {{> searchDate "from_register_date"}}
        {{> searchDate "untl_register_date"}}
      </div>
    </div>
  -->
    <!-- <button id="search_button">Search</button> -->
  </div>

</template>

<template name="searchDate">
  <input type="hidden" id = "s_{{this}}" class = "search_input" value="{{fromSessionP this}}"/>
  <input class="datepicker" id = "date_{{this}}" type="text"/>
</template>

<template name = "search_results">
  <div class = "search_panel">
    <table id = "search_results" width = "100%">
      <tr>
        <th class = "sort" id = "sort_device_type">Device Type</th>
        <th class = "sort" id = "sort_install_date">Install Date</th>
        <th class = "sort" id = "sort_schedule_date">Schedule Date</th>
        <th class = "sort" id = "sort_agency">Agency</th>
        <th class = "sort" id = "sort_hw_id">Hardware ID</th>
        <th class = "sort" id = "sort_device_id">Device ID</th>
        <th class = "sort" id = "sort_service_id">Service Account ID</th>
        <th class = "sort" id = "sort_lsam_id">LSAM ID</th>
        <th class = "sort" id = "sort_station_name">Location</th>
        <th class = "sort" id = "sort_sam_tracking">SAM Location</th>
        <th class = "sort" id = "sort_hw_status">H/W Status</th>
        <th class = "sort" id = "sort_sw_status">S/W Status</th>
      </tr>
      <br>
      {{#each results}}
        <tr class = "device_item {{evenrow @index}} {{isUrgent}}" >
          <td>{{device_type}}</td>
          <td>{{toDate install_date}}</td>
          <td>{{toDate schedule_date}}</td>
          <td>{{agency}}</td>
          <td>{{hw_id}}</td>
          <td>{{device_id}}</td>
          <td>{{service_id}}</td>
          <td>{{lsam_id}}</td>
          <td>{{station_name}} {{line}}</td>
          <td>{{sam_tracking}}</td>
          <td class = "{{lower hw_status}}">{{hw_status}}</td>
          <td class = "{{lower sw_status}}">{{sw_status}}</td>
        </tr>
      {{/each}}
    </table>
  </div>
</template>



<template name = "device">
  {{#with device}}
    <br>
    <div class = "section">
      <h1>Hardware</h1>
      {{> device_field toObject "hw_status" this}}
      <br>
      {{> device_field toObject "urgent" this}}
      {{> device_field toObject "device_type" this}}
      {{> device_field toObject "hw_id" this}}
      {{> device_field toObject "device_id" this}}
      {{> device_field toObject "lsam_id" this}}
      {{> device_field toObject "label" this}}
      {{> device_field toObject "sam_tracking" this}}
      <br>
      {{> device_field toObject "hw_comments" this}}
      {{> device_field toObject "hw_error" this}}
    </div>
    <div class = "section">
      <h1>Software</h1>
      {{> device_field toObject "sw_status" this}}
      <br>
      {{> device_field toObject "sw_version" this}}
      {{> device_field toObject "service_id" this}}
      {{> device_field toObject "feeset_id" this}}
      {{> device_field toObject "firmware_type" this}}
      {{> device_field toObject "status_of_installation" this}}
      <br>
      {{> device_field toObject "sw_comments" this}}
      {{> device_field toObject "sw_error" this}}
    </div>

    <div class = "section">
      <h1>Agency</h1>
      {{> device_field toObject "agent_id" this}}
      {{> device_field toObject "agency" this}}
      {{> device_field toObject "sub_agency" this}}
      {{> device_field toObject "supervisor" this}}
      {{> device_field toObject "hp_number" this}}
      {{> device_field toObject "operator_name" this}}
      {{> device_field toObject "operator_id" this}}
      {{> device_field toObject "operator_card" this}}
    </div>
    <div class = "section">
      <h1>Location</h1>
      {{> device_field toObject "install_date" this}}
      {{> device_field toObject "schedule_date" this}}
      {{> device_field toObject "line" this}}
      {{> device_field toObject "station_id" this}}
      {{> device_field toObject "station_name" this}}
      {{> device_field toObject "location" this}}
    </div>
    <div class = "section">
      <h1>Network</h1>
      {{> device_field toObject "ip" this}}
      {{> device_field toObject "subnet" this}}
      {{> device_field toObject "gateway" this}}
      {{> device_field toObject "ntp" this}}
      {{> device_field toObject "dns1" this}}
      {{> device_field toObject "dns2" this}}
      {{> device_field toObject "host1" this}}
      {{> device_field toObject "host2" this}}
      {{> device_field toObject "host3" this}}
      {{> device_field toObject "swd" this}}
    </div>
  {{/with}}
</template>

<template name = "device_field">
  <div class = "device-field" id="{{name}}">
    {{> Template.dynamic template=(field_type name) }}
  </div>
</template>

<template name = "dropdown">
  <label>{{field_label name}}:</label>
  <select class = "device-input {{lower value}}" id = "edit_{{name}}" value="{{value}}">
    {{#each field_options name}}
      <option class = "{{lower this}}" {{selected_option this ../value}}> {{this}} </option>
    {{/each}}
  </select>
</template>

<template name = "text">
  <label>{{field_label name}}:</label> <input class = "device-input" type = "text" id = "edit_{{name}}" value = "{{value}}">
</template>

<template name = "date">
  <label>{{field_label name}}:</label>
  <input type="hidden" id = "edit_{{name}}" class = "device-input" value="{{value}}"/>
  <input class="datepicker" id = "date_{{name}}" type="text"/>
</template>

<template name = "checkbox">
  <label>{{field_label name}}:</label>
  <input type="checkbox" id = "edit_{{name}}" class = "device-input" {{isChecked}}/>
</template>
